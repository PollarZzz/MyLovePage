<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nossa Jornada Juntos ❤</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;600&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    
    <!-- Swiper.js -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />

    <!-- AOS (Animate On Scroll) Library -->
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />

    <!-- Estilos Personalizados -->
    <style>
        /* Adicionado scroll-behavior no seletor html na tag para rolagem suave */
        
        /* Configurações de tema claro (padrão) */
        :root {
            --bg-color: #FFF0F5; /* Lavender Blush */
            --text-color: #831843; /* Pink-900 */
            --text-muted-color: #be185d; /* Pink-700 */
            --header-bg: rgba(255, 255, 255, 0.8);
            --card-bg: #ffffff;
            --card-back-bg: #fdf2f8; /* Pink-50 */
            --section-bg: #fdf2f8; /* Pink-50 para seções com fundo */
        }

        /* Configurações de tema escuro */
        html.dark {
            --bg-color: #1f2937; /* Gray-800 */
            --text-color: #fce7f3; /* Pink-100 */
            --text-muted-color: #f9a8d4; /* Pink-300 */
            --header-bg: rgba(31, 41, 55, 0.8);
            --card-bg: #374151; /* Gray-700 */
            --card-back-bg: #4b5563; /* Gray-600 */
            --section-bg: #374151; /* Gray-700 para seções com fundo */
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.5s ease, color 0.5s ease;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Playfair Display', serif;
            color: var(--text-color);
        }
        .bg-section { background-color: var(--section-bg); }
        .font-cursive { font-family: 'Dancing Script', cursive; }
        .bg-custom-header { background-color: var(--header-bg); }
        .bg-custom-card { background-color: var(--card-bg); }
        .bg-custom-card-back { background-color: var(--card-back-bg); }
        .text-custom { color: var(--text-color); }
        .text-custom-muted { color: var(--text-muted-color); }

        #momentos {
            position: relative;
            transition: background-image 0.8s ease-in-out;
            background-size: cover;
            background-position: center;
        }
        #momentos::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(255, 240, 245, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1;
            transition: background-color 0.5s ease;
        }
        html.dark #momentos::before {
            background-color: rgba(31, 41, 55, 0.8);
        }
        #momentos .container {
            position: relative;
            z-index: 2;
        }
        
        .voucher {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .voucher:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
        }
        .cut-animation {
            animation: cut-effect 0.8s forwards;
            overflow: hidden;
        }
        @keyframes cut-effect {
            0% { transform: rotate(0) translateY(0); opacity: 1; }
            20% { transform: rotate(-5deg) translateY(-10px); }
            40% { transform: rotate(5deg) translateY(0px); }
            100% { transform: rotate(0deg) translateY(100%) scale(0.5); opacity: 0; }
        }

        .icon-pulse:hover svg {
            animation: pulse-heart 1s infinite;
        }
        @keyframes pulse-heart {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .timeline-item-content {
            transition: transform 0.3s ease;
        }
        .timeline-item-content:hover {
             transform: scale(1.03);
        }
        .timeline-item::after {
            content: ''; position: absolute; width: 25px; height: 25px; right: -12px; background-color: var(--card-bg);
            border: 4px solid #f472b6; top: 15px; border-radius: 50%; z-index: 1;
        }
        .timeline-container::before {
            content: ''; position: absolute; left: 50%; transform: translateX(-50%); width: 4px;
            height: 100%; background-color: #f472b6;
        }
        .timeline-item:nth-child(even) { padding-left: calc(50% + 30px); padding-right: 0; text-align: left; }
        .timeline-item:nth-child(odd) { padding-right: calc(50% + 30px); padding-left: 0; text-align: right; }
        .timeline-item:nth-child(even)::after { left: -12px; }

        .swiper-container { width: 100%; padding-bottom: 50px; }
        .swiper-slide { text-align: center; font-size: 18px; display: flex; justify-content: center; align-items: center; border-radius: 16px; overflow: hidden; background-color: var(--card-bg); }
        .photo-swiper-container .swiper-slide { background-position: center; background-size: cover; width: 75%; max-width: 350px; height: 500px; }
        .swiper-pagination-bullet-active { background-color: #f472b6 !important; }
        .nav-link { transition: color 0.3s ease-in-out; }
        .nav-link:hover { color: #f472b6; }
        .card-container { perspective: 1000px; }
        .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.9s cubic-bezier(0.25, 0.8, 0.25, 1); transform-style: preserve-3d; }
        .card-container.flipped .card-inner { transform: rotateY(180deg); }
        .card-front, .card-back { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; border-radius: 1rem; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05); }
        .card-back { transform: rotateY(180deg); }
        
        /* ANIMAÇÃO DE ELOGIO */
        @keyframes compliment-pop-in {
            0% { transform: scale(0.8) translateY(20px); opacity: 0; }
            100% { transform: scale(1) translateY(0); opacity: 1; }
        }
        .compliment-animate-in {
            animation: compliment-pop-in 0.5s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
        }

        /* ANIMAÇÃO DE PARTÍCULAS (para o botão de elogio) */
        .particle {
            position: absolute;
            background-color: #f472b6;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0;
            animation: burst 0.7s ease-out forwards;
        }
        @keyframes burst {
            0% { transform: scale(0.5); opacity: 1; }
            100% { transform: scale(1) translate(var(--x), var(--y)); opacity: 0; }
        }
        
        #home-content { position: relative; z-index: 2; }
        #falling-stars-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
    </style>
</head>
<body class="antialiased">

    <!-- Header e Navegação -->
    <header class="bg-custom-header backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold font-cursive">Pollzin & Gigi</h1>
            <div class="flex items-center space-x-4">
                 <button id="theme-toggle" class="p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-pink-400" aria-label="Alternar tema de cores">
                    <svg id="theme-icon-light" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                    <svg id="theme-icon-dark" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
                </button>
                <button id="menu-btn" class="md:hidden block" aria-label="Abrir menu" aria-expanded="false" aria-controls="mobile-menu">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg>
                </button>
                <nav id="menu" class="hidden md:flex space-x-6 text-sm">
                    <a href="#home" class="nav-link">Início</a>
                    <a href="#timeline" class="nav-link">História</a>
                    <a href="#momentos" class="nav-link">Momentos</a>
                    <a href="#musica" class="nav-link">Nossa Trilha</a>
                    <a href="#vales" class="nav-link">Vales</a>
                    <a href="#cartas" class="nav-link">Cartas</a>
                    <a href="#elogios" class="nav-link">Elogios</a>
                    <a href="#memorias" class="nav-link">Memórias</a>
                </nav>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-custom-card">
            <a href="#home" class="block py-2 px-6 text-sm hover:bg-pink-50/50">Início</a>
            <a href="#timeline" class="block py-2 px-6 text-sm hover:bg-pink-50/50">História</a>
            <a href="#momentos" class="block py-2 px-6 text-sm hover:bg-pink-50/50">Momentos</a>
            <a href="#musica" class="block py-2 px-6 text-sm hover:bg-pink-50/50">Nossa Trilha</a>
            <a href="#vales" class="block py-2 px-6 text-sm hover:bg-pink-50/50">Vales</a>
            <a href="#cartas" class="block py-2 px-6 text-sm hover:bg-pink-50/50">Cartas</a>
            <a href="#elogios" class="block py-2 px-6 text-sm hover:bg-pink-50/50">Elogios</a>
            <a href="#memorias" class="block py-2 px-6 text-sm hover:bg-pink-50/50">Memórias</a>
        </div>
    </header>

    <main>
        <!-- Seção Home -->
        <section id="home" class="relative text-center py-20 px-6 overflow-hidden">
            <canvas id="falling-stars-canvas"></canvas>
            <div id="home-content" class="container mx-auto">
                <img src="images/foto.png" alt="Foto de um casal se abraçando e sorrindo" class="w-48 h-48 rounded-full mx-auto mb-8 border-4 border-white shadow-lg" data-aos="zoom-in" data-aos-delay="200" loading="lazy">
                <h1 class="text-4xl md:text-6xl font-bold mb-4 font-cursive" data-aos="fade-down">Nossa Jornada</h1>
                <p class="text-lg text-custom-muted max-w-2xl mx-auto mb-8" data-aos="fade-up" data-aos-delay="400">
                    Oii gatinha, criei este pequeno universo para nós. Um lugar onde nossas memórias, risadas e sonhos podem viver para sempre. Espero que goste.
                </p>
                <div class="bg-white/70 backdrop-blur-sm p-6 rounded-xl inline-block shadow-md" data-aos="fade-up" data-aos-delay="600">
                    <h3 class="text-2xl font-bold text-pink-500">Estamos juntos há:</h3>
                    <div id="contador" class="text-xl md:text-2xl font-bold text-pink-800 mt-2 whitespace-nowrap"></div>
                </div>
            </div>
        </section>

        <!-- Seção Linha do Tempo -->
        <section id="timeline" class="py-20 px-6 bg-section">
             <div class="container mx-auto text-center">
                <h2 class="text-4xl font-bold mb-12" data-aos="fade-up">Nossa História</h2>
                <div id="timeline-container" class="relative timeline-container" data-aos="fade-up" data-aos-delay="200">
                    <!-- Itens da linha do tempo serão injetados aqui via JS -->
                </div>
            </div>
        </section>
        
        <!-- Seção Nossos Momentos -->
        <section id="momentos" class="py-20 px-6">
            <div class="container mx-auto text-center">
                <h2 class="text-4xl font-bold mb-2">Nossos Momentos Especiais</h2>
                <p class="text-custom-muted mb-12">Cada foto, uma página da nossa história.</p>
                <div class="swiper-container photo-swiper-container">
                    <div class="swiper-wrapper" id="galeria-fotos">
                        <!-- Slides da galeria serão injetados aqui via JS -->
                    </div>
                    <div class="swiper-pagination photo-pagination"></div>
                </div>
            </div>
        </section>

        <!-- Seção Trilha Sonora -->
        <section id="musica" class="py-20 px-6 bg-section">
            <div class="container mx-auto text-center" data-aos="fade-up">
                <h2 class="text-4xl font-bold mb-2">A Trilha Sonora do Nosso Amor</h2>
                <p class="text-custom-muted mb-8">Dê o play nas músicas que embalam nossos corações.</p>
                <div class="max-w-lg mx-auto shadow-2xl rounded-xl overflow-hidden">
                    <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/5KlA8ENHkbFhTGXREW6XBg?utm_source=generator&theme=0" width="100%" height="352" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy" title="Playlist do Spotify para o casal"></iframe>
                </div>
            </div>
        </section>

        <!-- Seção Vale-Presente -->
        <section id="vales" class="py-20 px-6">
            <div class="container mx-auto text-center">
                <h2 class="text-4xl font-bold mb-12" data-aos="fade-up">Vales Para o Futuro</h2>
                <div id="vouchers-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Vales serão injetados aqui via JS -->
                </div>
            </div>
        </section>

        <!-- Seção "Abra Quando..." -->
        <section id="cartas" class="py-20 px-6 bg-section">
            <div class="container mx-auto text-center">
                <h2 class="text-4xl font-bold mb-12" data-aos="fade-up">Abra Quando...</h2>
                <div id="cartas-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Cartas serão injetadas aqui via JS -->
                </div>
            </div>
        </section>

        <!-- Gerador de Elogios -->
        <section id="elogios" class="py-20 px-6">
            <div class="container mx-auto text-center">
                <h2 class="text-4xl font-bold mb-12" data-aos="fade-up">Um Elogio Para Você</h2>
                <div class="max-w-3xl mx-auto bg-custom-card p-8 rounded-2xl shadow-lg relative overflow-hidden" data-aos="zoom-in-up">
                    <p id="compliment-text" class="text-2xl font-semibold h-20 flex items-center justify-center text-center transition-opacity duration-300" aria-live="polite"></p>
                    <button id="new-compliment-btn" class="mt-6 bg-pink-500 text-white font-bold py-3 px-8 rounded-lg hover:bg-pink-600 transition-all duration-300 shadow-md transform hover:scale-105">
                        Novo Elogio
                    </button>
                </div>
            </div>
        </section>

        <!-- Caixa de Memórias -->
        <section id="memorias" class="py-20 px-6 bg-section">
            <div class="container mx-auto text-center" data-aos="fade-up">
                <h2 class="text-4xl font-bold mb-12">Nossa Caixa de Memórias</h2>
                <p class="text-custom-muted mb-8 max-w-2xl mx-auto">Um lugar para guardarmos juntos nossas lembranças favoritas. Faça login com o Google para adicionar uma nova memória!</p>
                
                <div class="max-w-2xl mx-auto bg-custom-card p-8 rounded-xl shadow-lg">
                    <div id="auth-container">
                        <div id="user-info" class="hidden items-center justify-between mb-6">
                            <div class="flex items-center gap-4">
                                <img id="user-photo" class="w-12 h-12 rounded-full" src="" alt="Foto do Usuário">
                                <span id="user-name" class="font-bold"></span>
                            </div>
                            <button id="logout-button" class="bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors text-sm">Sair</button>
                        </div>
                        <button id="login-button" class="bg-pink-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-pink-600 transition-colors shadow-md w-full">
                            <svg class="inline-block w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M22.56,12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26,1.37-1.04,2.53-2.21,3.31v2.77h3.57c2.08-1.92,3.28-4.74,3.28-8.09Z" fill="#4285F4"/><path d="M12,23c2.97,0,5.46-.98,7.28-2.66l-3.57-2.77c-.98.66-2.23,1.06-3.71,1.06-2.86,0-5.29-1.93-6.16-4.53H2.18v2.84C3.99,20.53,7.7,23,12,23Z" fill="#34A853"/><path d="M5.84,14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43,8.55,1,10.22,1,12s.43,3.45,1.18,4.93l3.66-2.84Z" fill="#FBBC05"/><path d="M12,5.38c1.62,0,3.06.56,4.21,1.64l3.15-3.15C17.45,1.45,14.97,0,12,0,7.7,0,3.99,2.47,2.18,5.91l3.66,2.84c.87-2.6,3.3-4.53,6.16-4.53Z" fill="#EA4335"/></svg>
                            Entrar com Google
                        </button>
                        <div id="auth-message" class="hidden mt-4 text-red-600 font-semibold"></div>
                    </div>

                    <div id="memory-box-content" class="hidden">
                        <form id="form-memoria" class="flex flex-col sm:flex-row gap-4 my-8">
                            <input type="text" id="input-memoria" placeholder="Escreva uma nova memória..." class="flex-grow p-3 border border-pink-200 rounded-lg focus:ring-2 focus:ring-pink-400 focus:outline-none transition text-gray-800" required>
                            <button type="submit" class="bg-pink-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-pink-600 transition-colors shadow-md">Adicionar</button>
                        </form>
                        <div id="lista-memorias" class="space-y-4 text-left">
                            <p class="text-gray-500">Carregando memórias...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>
    
    <!-- Footer -->
    <footer class="bg-custom-header text-center p-8 mt-12">
        <p class="text-lg font-cursive" data-aos="fade-up" data-aos-anchor-placement="top-bottom">Feito com todo o meu amor, para a mulher da minha vida.</p>
        <p class="text-sm opacity-70 mt-2 icon-pulse">
            <svg class="h-5 w-5 inline-block text-pink-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd" /></svg>
        </p>
    </footer>

    <!-- Scripts -->
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    
    <script type="module">
        // Importações do Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithRedirect, getRedirectResult, signOut, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, onSnapshot, serverTimestamp, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // ##### ÁREA DE CUSTOMIZAÇÃO #####
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        const AUTHORIZED_EMAILS = ['oipolarkk@gmail.com', 'email-dela-aqui@gmail.com'];
        const DATA_INICIO_NAMORO = new Date(2022, 11, 8, 20, 0, 0); // 8 de Dezembro de 2022
        
        const LISTA_DE_FOTOS_E_LEGENDAS = [
            { url: 'images/foto1.jpeg', legenda: 'Minha história de amor preferida é a nossa.' },
            { url: 'images/foto2.jpeg', legenda: 'Cada momento ao seu lado é o meu presente favorito.' },
            { url: 'images/foto3.jpeg', legenda: 'Encontrei meu paraíso quando encontrei você.' },
            { url: 'images/foto4.jpeg', legenda: 'Você é o meu "felizes para sempre" acontecendo agora.' },
            { url: 'images/foto5.jpeg', legenda: 'MODO SERIO -_- KKK' },
            { url: 'images/foto6.jpeg', legenda: 'Você transforma momentos simples em memórias inesquecíveis.' },
            { url: 'images/foto7.jpeg', legenda: 'O amor era só uma palavra até você chegar para dar sentido.' },
            { url: 'images/foto8.jpeg', legenda: 'Ao seu lado, descobri que o amor é a maior de todas as aventuras.' },
            { url: 'images/foto9.jpeg', legenda: 'Obrigado por ser a melhor e mais bonita parte da minha vida.' },
            { url: 'images/foto10.jpeg', legenda: 'Que sorte a minha ter seu amor para chamar de meu.' },
            { url: 'images/foto11.jpeg', legenda: 'Amar você é a parte mais fácil e natural do meu dia.' },
            { url: 'images/foto12.jpeg', legenda: 'Juntos. É o meu lugar preferido de estar.' },
            { url: 'images/foto13.jpeg', legenda: 'Em cada detalhe seu, encontro um novo motivo para te amar.' },
            { url: 'images/foto14.jpeg', legenda: 'eu amor por você cresce muito mais a cada amanhecer.' },
            { url: 'images/foto15.jpeg', legenda: 'Com você, o "para sempre" parece pouco tempo.' },
            { url: 'images/foto16.jpeg', legenda: 'Você é mais do que eu sonhei, é tudo que eu preciso.' },
            { url: 'images/foto17.jpeg', legenda: 'Você é a razão do meu sorriso mais sincero e espontâneo.' },
        ];
        
        const CARTAS_PARA_ABRIR = [
            { titulo: "...estiver com saudades.", mensagem: "Feche os olhos e sinta a imensidão da distância que o universo nos ensina, mas lembre-se que meu amor por você é como a gravidade, nos mantendo sempre juntos, não importa a galáxia.", icone: "🌌" },
            { titulo: "...precisar de um sorriso.", mensagem: "Lembre daquela estrela cadente que vimos juntos? Seu sorriso ilumina mais que um milhão delas! É a luz mais brilhante do meu universo.", icone: "🌠" },
            { titulo: "...duvidar do meu amor.", mensagem: "Nunca duvide. Meu amor por você é mais vasto que o próprio universo, em constante expansão e sem limites. Você é meu Big Bang particular, o início de tudo de bom na minha vida.", icone: "💖" },
            { titulo: "...estiver tendo um dia difícil.", mensagem: "Respire fundo e visualize a calma do espaço sideral. Você é a estrela mais resiliente da minha constelação. Estou aqui, como um planeta que sempre te orbita. Tudo vai se alinhar como os astros.", icone: "🪐" },
            { titulo: "...precisar de inspiração.", mensagem: "Olhe para a complexidade e a beleza do cosmos e saiba que sua capacidade de criar e transformar é tão infinita quanto. Você é a supernova que inspira a criação de novas estrelas em mim.", icone: "💫" },
            { titulo: "...quiser sonhar comigo.", mensagem: "Vamos sonhar com viagens interplanetárias, com nosso futuro sendo tão brilhante quanto a Via Láctea. Nossos sonhos juntos são as galáxias que quero explorar ao seu lado.", icone: "🚀" }
        ];

        const timelineData = [
            { date: "08 de Dezembro, 2022", title: "O Início de Tudo" },
            { date: "25 de Dezembro, 2022", title: "Nosso Primeiro Natal Juntos" },
            { date: "19 de Março, 2023", title: "Nossa Primeira Viagem" },
            { date: "08 de Dezembro, 2023", title: "1 Ano de Namoro" }
        ];

        const vouchersData = [
            { title: "Jantar Romântico", description: "Uma noite especial com um jantar delicioso feito por mim.", icon: "🍝" },
            { title: "Noite de Cinema", description: "Sua escolha de filme, com muita pipoca e guloseimas.", icon: "🎬" },
            { title: "Massagem Relaxante", description: "Um momento para você relaxar e esquecer do mundo.", icon: "💆‍♀️" }
        ];
        
        const compliments = [
            "Seu sorriso é um universo de luz, capaz de acender até as estrelas mais distantes. É lindo demais!",
            "Você não deve ser daqui... só pode ter vindo de uma galáxia muito, muito distante, de onde toda a beleza do cosmo se derramou em você!",
            "Antes de você, minha vida era um cantinho escuro do universo. Agora, é uma explosão de cores e sentimentos, uma supernova de amor!",
            "Seu abraço é como a gravidade mais gostosa do mundo: me puxa pra perto e me prende em você, e eu nem quero escapar!",
            "Você não é um cometa, mas passou pela minha vida e roubou meu coração rapidinho, com a precisão de um raio de luz!",
            "Meu amor por você é maior que a distância entre a Terra e a galáxia mais distante... e olha que isso é um tantão de amor!",
            "Você é meu sol particular, que ilumina cada cantinho dos meus dias e me aquece por dentro com um calorzinho que só você tem.",
            "Seu beijo é uma viagem inesquecível, um pouso suave na lua que me faz flutuar de tanta felicidade.",
            "Seu amor é como o universo, infinito e em constante expansão dentro do meu coração. Ele só cresce e cresce!",
            "Você não precisa de foguete, porque só de sorrir, você já me leva para o espaço sideral, para um lugar só nosso.",
            "Nossa conexão é tão forte que nem a velocidade da luz conseguiria nos separar. É um laço que transcende tudo!",
            "Você é a minha estrela-guia, que ilumina o caminho e me mostra a direção, mesmo nas noites mais escuras da vida.",
            "Quando estamos juntos, sinto que a gente teletransporta para um planeta só nosso, onde tudo é mágico e perfeito.",
            "Você deve ser feita de poeira estelar, porque tem uma magia que encanta e ilumina tudo ao seu redor. É pura luz!",
            "Meu coração dá um 'boom' cósmico, um salto quântico de alegria, toda vez que teus olhos cruzam os meus.",
            "Você é a constelação mais linda que já vi, e todas as minhas estrelas e desejos te pertencem. Sou todo seu!",
            "Nosso amor é tão, mas tão grande, que ultrapassa a órbita de Plutão! Sim, até Plutão sabe do nosso amor infinito!",
            "Você é o oxigênio do meu foguete, a força que me impulsiona! Sem você, eu nem sairia do chão para sonhar.",
            "Seu charme é um campo gravitacional irresistível: me atrai, me puxa pra perto e não me deixa ir embora. E eu amo ficar!",
            "Você não é um asteroide, mas meu coração caiu por você em uma queda livre deliciosa e sem volta. Caí de amores!",
            "Com você ao meu lado, sinto que posso conquistar o universo inteiro, um planeta de cada vez. Você me inspira!",
            "Você é a paisagem mais bonita que meu telescópio já viu, a vista mais espetacular de todos os dias e noites.",
            "Meu amor por você é como o tempo-espaço: contínuo, eterno e sem fim. Não tem começo nem fim para o que sinto.",
            "Você não é um ET, mas parece de outro mundo de tão perfeita, de tão incrível. Você é um presente de outro planeta!",
            "Seu olhar é um portal mágico que me leva para um universo particular, cheio de amor, carinho e muita doçura.",
            "Você é a minha Via Láctea particular, cheia de brilho, mistérios e maravilhas que me encantam a cada dia.",
            "Nossa história é como a formação de um novo planeta: única, especial e em constante evolução, crescendo e se tornando cada vez mais linda.",
            "Você me faz sentir como se eu tivesse descoberto uma nova galáxia a cada dia que passa. É sempre uma surpresa maravilhosa estar com você!",
            "Seu abraço é como uma atmosfera protetora, um escudo que me envolve, me deixando seguro, aquecido e muito feliz.",
            "Você é a gravidade que me mantém com os pés no chão, mas que, ao mesmo tempo, me faz sonhar com as estrelas e com um futuro lindo ao seu lado."
        ];
        let availableCompliments = [...compliments];
        // ##### FIM DA ÁREA DE CUSTOMIZAÇÃO #####
        
        let db, auth;
        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
        } catch (e) {
            console.error("Erro ao inicializar o Firebase:", e);
            const memoriasSection = document.getElementById('memorias');
            if(memoriasSection) memoriasSection.innerHTML = '<p class="text-red-500 text-center">Erro ao conectar com a Caixa de Memórias.</p>';
        }

        // --- Inicializador principal da aplicação ---
        document.addEventListener('DOMContentLoaded', async function() {
            AOS.init({ duration: 800, once: true, offset: 50 });
            
            setupThemeToggle();
            setupContador();
            setupTimeline();
            setupGallery();
            setupVouchers();
            setupCards();
            setupComplimentGenerator();
            setupMenu();
            setupFallingStars(); // NOVA FUNÇÃO: Animação de estrelas
            
            await setupAuthAndMemories(); 
        });

        // --- MÓDULOS DE FUNCIONALIDADES ---
        
        // NOVA FUNÇÃO: Animação de Estrelas Caindo
        function setupFallingStars() {
            const canvas = document.getElementById('falling-stars-canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            let stars = [];
            const numStars = 100;

            function resizeCanvas() {
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;
                stars = []; // Reinicia as estrelas ao redimensionar
                for (let i = 0; i < numStars; i++) {
                    stars.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        radius: Math.random() * 1.5 + 0.5,
                        speed: Math.random() * 0.8 + 0.2
                    });
                }
            }

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                const isDark = document.documentElement.classList.contains('dark');
                ctx.fillStyle = isDark ? '#fce7f3' : '#be185d';

                for (let i = 0; i < numStars; i++) {
                    const star = stars[i];
                    ctx.beginPath();
                    ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                    ctx.fill();

                    star.y += star.speed;
                    if (star.y > canvas.height + star.radius) {
                        star.y = 0 - star.radius;
                        star.x = Math.random() * canvas.width;
                    }
                }
                requestAnimationFrame(draw);
            }
            
            window.addEventListener('resize', resizeCanvas);
            resizeCanvas();
            draw();
        }
        
        // NOVA FUNÇÃO: Efeito de explosão de partículas
        function createParticleBurst(x, y) {
            const particleContainer = document.body;
            const particleCount = 20;
            const isDark = document.documentElement.classList.contains('dark');
            const colors = ['#f472b6', '#ec4899', '#db2777', isDark ? '#f9a8d4' : '#9d174d'];

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                particle.style.left = `${x}px`;
                particle.style.top = `${y}px`;
                particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                
                const size = Math.random() * 6 + 2;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                const angle = Math.random() * 360;
                const distance = Math.random() * 80 + 50;
                const endX = Math.cos(angle * Math.PI / 180) * distance;
                const endY = Math.sin(angle * Math.PI / 180) * distance;

                particle.style.setProperty('--x', `${endX}px`);
                particle.style.setProperty('--y', `${endY}px`);

                particleContainer.appendChild(particle);

                particle.addEventListener('animationend', () => {
                    particle.remove();
                });
            }
        }

        function setupThemeToggle() {
            const toggle = document.getElementById('theme-toggle');
            const lightIcon = document.getElementById('theme-icon-light');
            const darkIcon = document.getElementById('theme-icon-dark');

            const applyTheme = (isDark) => {
                document.documentElement.classList.toggle('dark', isDark);
                lightIcon.classList.toggle('hidden', isDark);
                darkIcon.classList.toggle('hidden', !isDark);
            };

            toggle.addEventListener('click', () => {
                const isDark = !document.documentElement.classList.contains('dark');
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
                applyTheme(isDark);
            });

            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            applyTheme(savedTheme === 'dark' || (!savedTheme && prefersDark));
        }
        
        function setupContador() {
            const contadorEl = document.getElementById('contador');
            if (!contadorEl) return;
            
            const atualizarContador = () => {
                const agora = new Date();
                const diff = agora - DATA_INICIO_NAMORO;
                
                const anos = Math.floor(diff / 31556952000);
                const meses = Math.floor((diff % 31556952000) / 2629746000);
                const dias = Math.floor((diff % 2629746000) / 86400000);
                const horas = Math.floor((diff % 86400000) / 3600000);
                const minutos = Math.floor((diff % 3600000) / 60000);
                const segundos = Math.floor((diff % 60000) / 1000);
                
                contadorEl.innerHTML = `${anos}a ${meses}m ${dias}d <br> ${String(horas).padStart(2, '0')}h ${String(minutos).padStart(2, '0')}m ${String(segundos).padStart(2, '0')}s`;
            }
            atualizarContador();
            setInterval(atualizarContador, 1000);
        }

        function setupTimeline() {
            const container = document.getElementById('timeline-container');
            if (!container) return;
            container.innerHTML = '';
            timelineData.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'timeline-item relative mb-8 p-4';
                itemDiv.setAttribute('data-aos', 'fade-up');

                const contentDiv = document.createElement('div');
                contentDiv.className = 'timeline-item-content bg-custom-card rounded-lg shadow-lg p-6';

                const titleH3 = document.createElement('h3');
                titleH3.className = 'font-bold text-lg text-pink-500';
                titleH3.textContent = item.title;

                const dateP = document.createElement('p');
                dateP.className = 'text-sm text-custom-muted';
                dateP.textContent = item.date;
                
                contentDiv.appendChild(titleH3);
                contentDiv.appendChild(dateP);
                itemDiv.appendChild(contentDiv);
                container.appendChild(itemDiv);
            });
        }

        function setupGallery() {
            const galeriaContainer = document.getElementById('galeria-fotos');
            const momentosSection = document.getElementById('momentos');
            if (!galeriaContainer || !momentosSection) return;
            
            galeriaContainer.innerHTML = '';
            LISTA_DE_FOTOS_E_LEGENDAS.forEach(foto => {
                const slideDiv = document.createElement('div');
                slideDiv.className = 'swiper-slide';
                slideDiv.style.backgroundImage = `url('${foto.url}')`;
                slideDiv.setAttribute('data-bg-url', foto.url);

                const legendaWrapper = document.createElement('div');
                legendaWrapper.className = 'absolute bottom-0 w-full bg-black/60 text-white p-4';
                
                const legendaP = document.createElement('p');
                legendaP.className = 'text-sm font-light';
                legendaP.textContent = foto.legenda;

                legendaWrapper.appendChild(legendaP);
                slideDiv.appendChild(legendaWrapper);
                galeriaContainer.appendChild(slideDiv);
            });

            const swiper = new Swiper('.photo-swiper-container', { 
                effect: 'coverflow', grabCursor: true, centeredSlides: true, slidesPerView: 'auto', loop: true, 
                coverflowEffect: { rotate: 0, stretch: 0, depth: 100, modifier: 2, slideShadows: false }, 
                pagination: { el: '.photo-pagination', clickable: true }, 
                autoplay: { delay: 3500, disableOnInteraction: false },
                on: {
                    slideChange: function () {
                        if (this.slides[this.activeIndex]) {
                            const bgUrl = this.slides[this.activeIndex].getAttribute('data-bg-url');
                            if (bgUrl) momentosSection.style.backgroundImage = `url('${bgUrl}')`;
                        }
                    },
                    init: function() {
                       setTimeout(() => {
                           if (this.slides[this.activeIndex]) {
                                const bgUrl = this.slides[this.activeIndex].getAttribute('data-bg-url');
                                if (bgUrl) momentosSection.style.backgroundImage = `url('${bgUrl}')`;
                            }
                       }, 100);
                    }
                }
            });
        }

        function setupVouchers() {
            const container = document.getElementById('vouchers-container');
            if (!container) return;
            container.innerHTML = '';
            vouchersData.forEach((voucher, index) => {
                const wrapperDiv = document.createElement('div');
                wrapperDiv.setAttribute('data-aos', 'fade-up');
                wrapperDiv.setAttribute('data-aos-delay', String(index * 100));

                const voucherDiv = document.createElement('div');
                voucherDiv.className = 'voucher bg-custom-card rounded-2xl shadow-lg p-6 flex flex-col items-center text-center relative overflow-hidden';

                const iconDiv = document.createElement('div');
                iconDiv.className = 'text-6xl mb-4';
                iconDiv.textContent = voucher.icon;

                const titleH3 = document.createElement('h3');
                titleH3.className = 'text-2xl font-bold mb-2';
                titleH3.textContent = voucher.title;

                const descP = document.createElement('p');
                descP.className = 'text-custom-muted mb-4 h-12';
                descP.textContent = voucher.description;

                const redeemBtn = document.createElement('button');
                redeemBtn.className = 'redeem-btn bg-pink-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-pink-600 transition-colors';
                redeemBtn.textContent = 'Resgatar';

                redeemBtn.addEventListener('click', (e) => {
                    const btn = e.currentTarget;
                    const voucherCard = btn.closest('.voucher');
                    if (voucherCard && !btn.disabled) {
                        btn.disabled = true;
                        btn.textContent = 'Resgatado!';
                        voucherCard.classList.add('cut-animation');
                        voucherCard.addEventListener('animationend', () => { 
                            voucherCard.style.visibility = 'hidden'; 
                        }, { once: true });
                    }
                }, { once: true });

                voucherDiv.append(iconDiv, titleH3, descP, redeemBtn);
                wrapperDiv.appendChild(voucherDiv);
                container.appendChild(wrapperDiv);
            });
        }
        
        function setupCards() {
            const container = document.getElementById('cartas-container');
            if (!container) return;
            container.innerHTML = '';
            CARTAS_PARA_ABRIR.forEach((carta, index) => {
                const cardWrapper = document.createElement('div');
                cardWrapper.setAttribute('data-aos', 'fade-up');
                cardWrapper.setAttribute('data-aos-delay', String(index * 100));

                const cardContainer = document.createElement('div');
                cardContainer.className = 'card-container h-64 cursor-pointer';
                cardContainer.addEventListener('click', () => cardContainer.classList.toggle('flipped'));

                const cardInner = document.createElement('div');
                cardInner.className = 'card-inner';
                
                const cardFront = document.createElement('div');
                cardFront.className = 'card-front bg-custom-card p-4 flex flex-col items-center justify-center';
                cardFront.innerHTML = `
                    <span class="text-5xl mb-4">${carta.icone}</span>
                    <h3 class="text-xl font-bold">${carta.titulo}</h3>
                    <p class="text-sm text-custom-muted mt-2">(Clique para ler)</p>`;

                const cardBack = document.createElement('div');
                cardBack.className = 'card-back bg-custom-card-back p-6 flex flex-col items-center justify-center';
                const backText = document.createElement('p');
                backText.className = 'text-center';
                backText.textContent = carta.mensagem;
                cardBack.appendChild(backText);

                cardInner.append(cardFront, cardBack);
                cardContainer.appendChild(cardInner);
                cardWrapper.appendChild(cardContainer);
                container.appendChild(cardWrapper);
            });
        }

        // FUNÇÃO DE ELOGIO MODIFICADA
        function setupComplimentGenerator() {
            const textEl = document.getElementById('compliment-text');
            const button = document.getElementById('new-compliment-btn');
            if (!textEl || !button) return;

            const getCompliment = () => {
                if (availableCompliments.length === 0) {
                    availableCompliments = [...compliments];
                }
                const index = Math.floor(Math.random() * availableCompliments.length);
                const compliment = availableCompliments[index];
                availableCompliments.splice(index, 1);
                return compliment;
            };
            
            // Define o primeiro elogio sem animação
            textEl.textContent = getCompliment();

            button.addEventListener('click', (e) => {
                // Chama a explosão de partículas
                createParticleBurst(e.clientX, e.clientY);
                
                // Animação para o texto
                textEl.classList.remove('compliment-animate-in');
                
                // Força um "reflow" para a animação poder ser reiniciada
                void textEl.offsetWidth; 
                
                setTimeout(() => {
                    textEl.textContent = getCompliment();
                    textEl.classList.add('compliment-animate-in');
                }, 100); // Pequeno delay para a transição ser mais suave
            });

            // Remove a classe de animação quando ela termina
             textEl.addEventListener('animationend', () => {
                textEl.classList.remove('compliment-animate-in');
            });
        }

        function setupMenu() {
            const menuBtn = document.getElementById('menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            
            menuBtn.addEventListener('click', () => {
                const isExpanded = mobileMenu.classList.toggle('hidden');
                menuBtn.setAttribute('aria-expanded', !isExpanded);
            });
            
            document.querySelectorAll('#mobile-menu a, #menu a').forEach(link => {
                link.addEventListener('click', () => {
                    if (!mobileMenu.classList.contains('hidden')) {
                        mobileMenu.classList.add('hidden');
                        menuBtn.setAttribute('aria-expanded', 'false');
                    }
                });
            });
        }

        async function setupAuthAndMemories() {
            if (!auth || !db) return; 

            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                try { await signInWithCustomToken(auth, __initial_auth_token); } 
                catch (error) { console.error("Erro no login com token, tentando anonimamente.", error); await signInAnonymously(auth); }
            } else { await signInAnonymously(auth); }

            const loginButton = document.getElementById('login-button');
            const logoutButton = document.getElementById('logout-button');
            const userInfoDiv = document.getElementById('user-info');
            const userNameSpan = document.getElementById('user-name');
            const userPhotoImg = document.getElementById('user-photo');
            const authMessageDiv = document.getElementById('auth-message');
            const memoryBoxContent = document.getElementById('memory-box-content');
            const formMemoria = document.getElementById('form-memoria');
            const inputMemoria = document.getElementById('input-memoria');
            const listaMemorias = document.getElementById('lista-memorias');
            
            const provider = new GoogleAuthProvider();
            loginButton.addEventListener('click', () => signInWithRedirect(auth, provider));
            logoutButton.addEventListener('click', () => signOut(auth));
            
            try { await getRedirectResult(auth); } 
            catch(error) { console.error("Erro no redirect:", error) };

            onAuthStateChanged(auth, user => {
                const isAuthorized = user && !user.isAnonymous && AUTHORIZED_EMAILS.includes(user.email);
                
                userInfoDiv.classList.toggle('hidden', !isAuthorized);
                userInfoDiv.classList.toggle('flex', isAuthorized);
                loginButton.classList.toggle('hidden', isAuthorized);
                memoryBoxContent.classList.toggle('hidden', !isAuthorized);
                
                if (isAuthorized) {
                    authMessageDiv.classList.add('hidden');
                    userNameSpan.textContent = user.displayName;
                    userPhotoImg.src = user.photoURL;
                    userPhotoImg.alt = `Foto de ${user.displayName}`;
                    loadMemories(user.uid);
                } else {
                    if (user && !user.isAnonymous) {
                        authMessageDiv.textContent = 'Acesso negado. Este é um cantinho especial.';
                        authMessageDiv.classList.remove('hidden');
                        signOut(auth);
                    }
                    listaMemorias.innerHTML = '';
                }
            });

            formMemoria.addEventListener('submit', async (e) => {
                e.preventDefault();
                const user = auth.currentUser;
                const memoryText = inputMemoria.value.trim();
                if (memoryText === '' || !user || user.isAnonymous) return;

                const submitButton = formMemoria.querySelector('button[type="submit"]');
                submitButton.disabled = true;

                try {
                    const memoriasCollectionPath = `/artifacts/${appId}/public/data/memorias-pollzin-gigi`;
                    await addDoc(collection(db, memoriasCollectionPath), {
                        texto: memoryText,
                        createdAt: serverTimestamp(),
                        owner: {
                            uid: user.uid,
                            name: user.displayName,
                            photo: user.photoURL
                        }
                    });
                    inputMemoria.value = '';
                } catch (error) {
                    console.error("Erro ao adicionar memória: ", error);
                } finally {
                    submitButton.disabled = false;
                }
            });

            function loadMemories() {
                const memoriasCollectionPath = `/artifacts/${appId}/public/data/memorias-pollzin-gigi`;
                const q = query(collection(db, memoriasCollectionPath));

                onSnapshot(q, (snapshot) => {
                    listaMemorias.innerHTML = '';
                    if (snapshot.empty) {
                        const noMemoriesP = document.createElement('p');
                        noMemoriesP.className = 'text-custom-muted';
                        noMemoriesP.textContent = 'Nenhuma memória ainda. Adicione a primeira!';
                        listaMemorias.appendChild(noMemoriesP);
                    } else {
                        const memorias = snapshot.docs
                            .map(doc => ({id: doc.id, ...doc.data()}))
                            .sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));

                        memorias.forEach(memoria => {
                            const div = document.createElement('div');
                            div.className = 'bg-section p-4 rounded-lg shadow-sm';
                            const textP = document.createElement('p');
                            textP.className = 'text-custom';
                            textP.textContent = memoria.texto;
                            div.appendChild(textP);
                            listaMemorias.appendChild(div);
                        });
                    }
                });
            }
        }

    </script>
</body>
</html>
